import{H as R,ah as N,a1 as A,b as s,a2 as k,ai as O,aj as U,ak as Q,al as T,I,am as j,Z as F,R as G,an as Y,ao as H,ap as K,F as w,aq as L,ar as Z,as as q,_ as z,D as m,o as c,e as x,w as g,g as D,j as v,t as y,h as J,B as W,i as X,c as b,f as _,l as ee,k as te}from"./main-7054a6f8.js";import{h as ae}from"./moment-fbc5633a.js";import{V as se}from"./VAlert-6db46ae6.js";import{V as le}from"./VForm-b6133dc8.js";import{V as ie}from"./VSheet-80e1c927.js";const S=R({name:"VRadio",props:{...N({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(e,t){let{slots:i}=t;return A(()=>s(O,k(e,{class:"v-radio",type:"radio"}),i)),{}}});const oe=R({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...U(),...Q(T(),["multiple"]),trueIcon:{type:I,default:"$radioOn"},falseIcon:{type:I,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:i,slots:n}=t;const u=j(),o=F(()=>e.id||`radio-group-${u}`),a=G(e,"modelValue");return A(()=>{const[l,r]=Y(i),[h,C]=H(e),[d,V]=K({...e,multiple:!1}),p=n.label?n.label({label:e.label,props:{for:o.value}}):e.label;return s(q,k({class:"v-radio-group"},l,h,{modelValue:a.value,"onUpdate:modelValue":f=>a.value=f,id:o.value}),{...n,default:f=>{let{id:$,messagesId:B,isDisabled:E,isReadonly:P}=f;return s(w,null,[p&&s(L,{id:$.value},{default:()=>[p]}),s(Z,k(d,{id:$.value,"aria-describedby":B.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:E.value,readonly:P.value,"aria-labelledby":p?$.value:void 0},r,{modelValue:a.value,"onUpdate:modelValue":M=>a.value=M}),n)])}})}),{}}}),re={data:()=>({NameRules:[e=>e?!0:"This field is required"],title:"",answers:[],alert_text:"",type:"success",snackbar:!0,selected:[],children:[],selectBox:[],child_id:"",child:"",numberOfMonth:"",skip:[],headerAndQuestions:[],examDate:""}),methods:{getQuestions(){m.get(`/api/evaluations/${this.$route.params.id}`).then(e=>{this.headerAndQuestions=e.data.evaluation}),m.get(`/api/evaluations/${this.$route.params.id}/show`).then(e=>{this.title=e.data.evaluation.title})},async submit(){const{valid:e}=await this.$refs.form.validate();e&&(this.answers=[],this.selected.forEach((t,i)=>{this.answers.push({question_id:i,value:t})}),m.post(`/api/evaluations/${this.$route.params.id}/submit`,{answers:this.answers,child_id:this.child_id,date:this.examDate}).then(t=>{t.data.status==200&&(this.child.childInMonths=-1,this.alert_text="evaluation added successfully ",this.type="success")}).catch(t=>{this.alert_text=t.response.data.message,this.type="error"}))},getChildren(){m.get("/api/child").then(e=>{this.children=e.data.children.forEach(t=>{this.selectBox.push({title:t.name,value:t.id})})})},radioChange(e,t,i){let n=0;if(this.skip[t]==null)this.skip[t]=[{id:i,answer:e}];else{let r=this.skip[t];r.forEach(h=>{h.id==i&&(n++,h.answer=e)}),n||(r.push({id:i,answer:e}),this.skip[t]=r)}let u=0,o=0,a=-1,l=-1;Object.entries(this.skip).reverse().forEach(r=>{const[h,C]=r;a=l,l=h;for(const d of C)if(d.answer==1)u++;else{u=0;break}if(u?(this.headerAndQuestions[h].length==u&&o++,u=0):o=0,o==2){for(const d of Object.entries(this.headerAndQuestions)){const[V,p]=d;if(h==V)break;p.forEach(f=>{this.selected[f.questions.id]=1})}this.answers=[],this.selected.forEach((d,V)=>{this.answers.push({question_id:V,value:d})}),m.post(`/api/evaluations/${this.$route.params.id}/${a}/basalAge`,{answers:this.answers,child_id:this.child_id,date:this.examDate}).then(d=>{console.log(d.data.resultEvaluation)}),this.$router.push({name:"Children",params:{alert:1}})}})},getSpecificChildren(){m.get(`/api/child/${this.child_id}/${this.$route.params.id}`).then(e=>{console.log(e.data.child),e.data.child.canDoExam?(this.alert_text="",this.child=e.data.child):(this.alert_text="sorry this child has this evaluate lass than 6 months",this.type="error",this.child=e.data.child,this.child.childInMonths=-1)})}},mounted(){this.getQuestions(),this.getChildren(),this.examDate=ae(new Date).format("YYYY-MM-DDTHH:mm"),console.log(this.examDate)},components:{}},de={class:"text-center"},ne={key:0},ue={class:"font-weight-bold mb-3 mx-7"},he={class:"border border-1 rounded pa-5"},ce={class:"mb-3"},me=v("div",{class:"mb-7"},null,-1);function pe(e,t,i,n,u,o){return c(),x(ie,{"max-width":"1200",class:"mx-auto"},{default:g(()=>[e.alert_text!=""?(c(),x(se,{key:0,type:e.type,variant:"tonal",border:"start",elevation:"2",closable:"","close-label":e.$t("close"),text:e.alert_text,class:"mb-8"},null,8,["type","close-label","text"])):D("",!0),v("h1",de,y(e.title),1),s(le,{"fast-fail":"",ref:"form",onSubmit:J(o.submit,["prevent"])},{default:g(()=>[s(W,{label:"Child",modelValue:e.child_id,"onUpdate:modelValue":[t[0]||(t[0]=a=>e.child_id=a),o.getSpecificChildren],items:e.selectBox,rules:e.NameRules},null,8,["modelValue","onUpdate:modelValue","items","rules"]),s(X,{modelValue:e.examDate,"onUpdate:modelValue":t[1]||(t[1]=a=>e.examDate=a),label:e.$t("examDate"),type:"datetime-local"},null,8,["modelValue","label"]),(c(!0),b(w,null,_(Object.values(e.headerAndQuestions).reverse(),a=>(c(),b("div",null,[a[0].min_age<=this.child.childInMonths?(c(),b("div",ne,[v("ul",null,[v("li",ue,y(a[0].title),1)]),(c(!0),b(w,null,_(a,l=>(c(),b("div",he,[v("div",ce,y(l.questions.title),1),s(oe,{modelValue:e.selected[l.questions.id],"onUpdate:modelValue":r=>e.selected[l.questions.id]=r,onChange:r=>o.radioChange(e.selected[l.questions.id],l.questions.evaluation_header_id,l.questions.id),rules:e.NameRules},{default:g(()=>[s(S,{label:"True",value:"1"}),s(S,{label:"False",value:"0"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","rules"])]))),256))])):D("",!0),me]))),256)),s(ee,{type:"submit",block:"",class:"mt-2"},{default:g(()=>[te(y(e.$t("submit")),1)]),_:1})]),_:1},8,["onSubmit"])]),_:1})}const ye=z(re,[["render",pe]]);export{ye as default};
