import{Z as R,aS as Y,ai as E,i as a,m as $,aT as O,aw as Q,aU as T,aV as j,$ as I,az as F,af as G,a8 as H,aA as K,aB as L,aW as z,F as k,aX as W,aY as X,aE as Z,_ as J,g as m,h as q,o as c,c as p,w as V,V as ee,f as D,t as g,j as _,d as te,C as ae,D as x,a as f,n as se,T as le,l as S}from"./main-87efbc3c.js";import{h as A}from"./moment-fbc5633a.js";import{s as ie}from"./inputtext.esm-a6682eab.js";import{s as oe}from"./calendar.esm-16786494.js";import{V as re}from"./VForm-7cc6cc8c.js";import{V as ne}from"./VSheet-0944ddd5.js";import"./basecomponent.esm-5488b03a.js";import"./button.esm-c67685b1.js";import"./overlayeventbus.esm-b77c1174.js";import"./portal.esm-547a0900.js";const B=R({name:"VRadio",props:{...Y({falseIcon:"$radioOff",trueIcon:"$radioOn"})},setup(e,t){let{slots:r}=t;return E(()=>a(O,$(e,{class:"v-radio",type:"radio"}),r)),{}}});const de=R({name:"VRadioGroup",inheritAttrs:!1,props:{height:{type:[Number,String],default:"auto"},...Q(),...T(j(),["multiple"]),trueIcon:{type:I,default:"$radioOn"},falseIcon:{type:I,default:"$radioOff"},type:{type:String,default:"radio"}},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:r,slots:u}=t;const h=F(),i=G(()=>e.id||`radio-group-${h}`),n=H(e,"modelValue");return E(()=>{const[l,s]=K(r),[o,C]=L(e),[d,y]=z({...e,multiple:!1}),v=u.label?u.label({label:e.label,props:{for:i.value}}):e.label;return a(Z,$({class:"v-radio-group"},l,o,{modelValue:n.value,"onUpdate:modelValue":b=>n.value=b,id:i.value}),{...u,default:b=>{let{id:w,messagesId:M,isDisabled:N,isReadonly:P}=b;return a(k,null,[v&&a(W,{id:w.value},{default:()=>[v]}),a(X,$(d,{id:w.value,"aria-describedby":M.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:N.value,readonly:P.value,"aria-labelledby":v?w.value:void 0},s,{modelValue:n.value,"onUpdate:modelValue":U=>n.value=U}),u)])}})}),{}}}),ue={components:{InputText:ie,Calendar:oe},data:()=>({valu:"",NameRules:[e=>e?!0:"This field is required"],title:"",answers:[],alert_text:"",type:"success",snackbar:!0,selected:[],children:[],selectBox:[],child_id:"",child:"",numberOfMonth:"",skip:[],headerAndQuestions:[],examDate:""}),methods:{fomate(){},goBack(){this.$router.go(-1)},getQuestions(){m.get(`/api/evaluations/${this.$route.params.id}`).then(e=>{this.headerAndQuestions=e.data.evaluation}),m.get(`/api/evaluations/${this.$route.params.id}/show`).then(e=>{this.title=e.data.evaluation.title})},async submit(){const{valid:e}=await this.$refs.form.validate();e&&(this.answers=[],this.selected.forEach((t,r)=>{this.answers.push({question_id:r,value:t})}),this.examDate=A(new Date).format("YYYY-MM-DD HH:mm"),m.post(`/api/evaluations/${this.$route.params.id}/submit`,{answers:this.answers,child_id:this.child_id,date:this.examDate}).then(t=>{t.data.status==200&&(this.child.childInMonths=-1,this.alert_text="evaluation added successfully ",this.type="success")}).catch(t=>{this.alert_text=t.response.data.message,this.type="error"}))},getChildren(){m.get("/api/child").then(e=>{this.children=e.data.children.forEach(t=>{this.selectBox.push({title:t.name,value:t.id})})})},radioChange(e,t,r){let u=0;if(this.skip[t]==null)this.skip[t]=[{id:r,answer:e}];else{let s=this.skip[t];s.forEach(o=>{o.id==r&&(u++,o.answer=e)}),u||(s.push({id:r,answer:e}),this.skip[t]=s)}let h=0,i=0,n=-1,l=-1;Object.entries(this.skip).reverse().forEach(s=>{const[o,C]=s;n=l,l=o;for(const d of C)if(d.answer==1)h++;else{h=0;break}if(h?(this.headerAndQuestions[o].length==h&&i++,h=0):i=0,i==2){for(const d of Object.entries(this.headerAndQuestions)){const[y,v]=d;if(o==y)break;v.forEach(b=>{this.selected[b.questions.id]=1})}this.answers=[],this.selected.forEach((d,y)=>{this.answers.push({question_id:y,value:d})}),m.post(`/api/evaluations/${this.$route.params.id}/${n}/basalAge`,{answers:this.answers,child_id:this.child_id,date:this.examDate}).then(d=>{console.log(d.data.resultEvaluation)}),this.$router.push({name:"Children",params:{alert:1}})}})},getSpecificChildren(){m.get(`/api/child/${this.child_id}/${this.$route.params.id}`).then(e=>{console.log(e.data.child),e.data.child.canDoExam?(this.alert_text="",this.child=e.data.child):(this.alert_text="sorry this child has this evaluate lass than 6 months",this.type="error",this.child=e.data.child,this.child.childInMonths=-1)})}},mounted(){this.getQuestions(),this.getChildren(),this.examDate=A(new Date).format("YYYY-MM-DD HH:mm"),console.log(this.examDate)}},he={class:"text-center"},ce={class:"card flex justify-content-center"},me={key:0},pe={class:"font-weight-bold mb-3 mx-7"},fe={class:"border border-1 rounded pa-5"},ve={class:"mb-3"},be=f("div",{class:"mb-7"},null,-1);function Ve(e,t,r,u,h,i){const n=q("Calendar");return c(),p("div",null,[a(_,{height:"45",class:"mb-5 text-white",color:"#A9AB7F",onClick:i.goBack},{default:V(()=>[a(ee,{start:"",icon:"mdi-arrow-left"}),D(" "+g(e.$t("back")),1)]),_:1},8,["onClick"]),a(ne,{"max-width":"1200",class:"mx-auto"},{default:V(()=>[e.alert_text!=""?(c(),te(ae,{key:0,type:e.type,variant:"tonal",border:"start",elevation:"2",closable:"","close-label":e.$t("close"),text:e.alert_text,class:"mb-8"},null,8,["type","close-label","text"])):x("",!0),f("h1",he,g(e.title),1),a(re,{"fast-fail":"",ref:"form",onSubmit:se(i.submit,["prevent"])},{default:V(()=>[a(le,{label:"Child",modelValue:e.child_id,"onUpdate:modelValue":[t[0]||(t[0]=l=>e.child_id=l),i.getSpecificChildren],items:e.selectBox,rules:e.NameRules},null,8,["modelValue","onUpdate:modelValue","items","rules"]),f("div",ce,[a(n,{style:{width:"100%"},modelValue:e.examDate,"onUpdate:modelValue":t[1]||(t[1]=l=>e.examDate=l),onChange:t[2]||(t[2]=l=>i.fomate()),"date-format":"dd-mm-yy",showIcon:"",rules:e.NameRules,"show-time":!0},null,8,["modelValue","rules"])]),(c(!0),p(k,null,S(Object.values(e.headerAndQuestions).reverse(),l=>(c(),p("div",null,[l[0].min_age<=this.child.childInMonths?(c(),p("div",me,[f("ul",null,[f("li",pe,g(l[0].title),1)]),(c(!0),p(k,null,S(l,s=>(c(),p("div",fe,[f("div",ve,g(s.questions.title),1),a(de,{modelValue:e.selected[s.questions.id],"onUpdate:modelValue":o=>e.selected[s.questions.id]=o,onChange:o=>i.radioChange(e.selected[s.questions.id],s.questions.evaluation_header_id,s.questions.id),rules:e.NameRules},{default:V(()=>[a(B,{label:"True",value:"1"}),a(B,{label:"False",value:"0"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","rules"])]))),256))])):x("",!0),be]))),256)),a(_,{type:"submit",block:"",class:"mt-2"},{default:V(()=>[D(g(e.$t("submit")),1)]),_:1})]),_:1},8,["onSubmit"])]),_:1})])}const Se=J(ue,[["render",Ve]]);export{Se as default};
