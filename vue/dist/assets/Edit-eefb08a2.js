import{_ as c,o as a,c as d,b as i,w as o,j as p,t as q,F as h,f as V,e as u,i as b,l as v,D as l,a as g,g as f,h as N,B as Q,x as k,k as A}from"./main-7054a6f8.js";import{V as y,a as P,b as H,c as E,d as I}from"./VExpansionPanel-b06f9204.js";import{V as w}from"./VAlert-6db46ae6.js";import{V as B}from"./VForm-b6133dc8.js";import{V as S}from"./VSheet-80e1c927.js";const x={name:"question",props:["header","questionsAndHeader"],emits:["question-inputs"],data:()=>({NameRules:[e=>e?!0:" Field is required."],headers:[],questionsNumbers:[1,2],questionCounter:2,questionInputs:[],color:"success",icon:"mdi-plus"}),methods:{addQuestion(){this.questionCounter<3?(this.questionsNumbers.push(++this.questionCounter),this.color="red",this.icon="mdi-minus"):(--this.questionCounter,this.questionsNumbers.splice(-1,1),this.questionInputs.splice(-1,1),this.color="success",this.icon="mdi-plus")},returnparent(){this.$emit("question-inputs",this.header.id,this.questionInputs)},setData(){if(console.log(this.questionsAndHeader),this.questionsAndHeader!=null){this.questionsNumbers=[];let e=1;this.questionsAndHeader.forEach(t=>{this.questionsNumbers.push(e++),this.questionInputs.push(t.questions.title)}),this.questionCounter=this.questionsAndHeader.length,this.questionCounter==3?(this.color="red",this.icon="mdi-minus"):(this.color="success",this.icon="mdi-plus")}this.returnparent()}},watch:{questionCounter(e){e>3&&this.questionsNumbers.splice(-1)}},created(){this.setData()}},F={class:"pa-4"},U={class:"d-flex justify-end"};function D(e,t,r,C,_,n){return a(),d(h,null,[i(y,{"expand-icon":"mdi-plus","collapse-icon":"mdi-minus"},{default:o(()=>[p("div",F,q(r.header.title),1)]),_:1}),i(P,null,{default:o(()=>[(a(!0),d(h,null,V(e.questionsNumbers,(m,s)=>(a(),u(b,{rules:e.NameRules,label:e.$t("question"),modelValue:e.questionInputs[s],"onUpdate:modelValue":$=>e.questionInputs[s]=$,onKeyup:n.returnparent},null,8,["rules","label","modelValue","onUpdate:modelValue","onKeyup"]))),256)),p("div",U,[i(v,{icon:e.icon,color:e.color,onClick:n.addQuestion},null,8,["icon","color","onClick"])])]),_:1})],64)}const R=c(x,[["render",D]]),T={data:()=>({NameRules:[e=>(e==null?void 0:e.length)>=3?!0:" name must be at least 3 characters."],evaluation:{title:"",side_profile_id:"",six_month:!0,questions:[]},alert_text:null,snackbar:!0,selected:[],headers:[],questions:[],headerAndQuestions:null,sideProfile:[]}),components:{questionComponent:R},methods:{async submit(){const{valid:e}=await this.$refs.form.validate();e&&(this.evaluation.questions=[],this.questions.forEach((t,r)=>{this.evaluation.questions.push({headerId:r,questions:t})}),l.post(`/api/evaluations/${this.$route.params.id}/update`,this.evaluation).then(t=>{t.data.status==200&&(this.alert_text="evaluation edited successfully ")}))},getSideProfile(){l.get("/api/side-profiles").then(e=>{this.sideProfile=e.data.sideProfile.map(t=>({title:t.title,value:t.id}))})},getQuestionHeaders(){l.get("/api/evaluationheaders").then(e=>{this.headers=e.data.headers,console.log(this.headers)})},getQuestions(){l.get(`/api/evaluations/${this.$route.params.id}`).then(e=>{this.headerAndQuestions=e.data.evaluation,console.log(this.headerAndQuestions)}),l.get(`/api/evaluations/${this.$route.params.id}/show`).then(e=>{this.evaluation.title=e.data.evaluation.title,this.evaluation.side_profile_id=e.data.evaluation.side_profile_id,e.data.evaluation.six_month==0&&(this.evaluation.six_month=!1)})},addQuestion(e,t){this.questions[e]=t}},created(){this.getQuestions(),this.getQuestionHeaders(),this.getSideProfile()}};function j(e,t,r,C,_,n){const m=g("questionComponent");return a(),u(S,{"max-width":"1200",class:"mx-auto"},{default:o(()=>[e.alert_text!=null?(a(),u(w,{key:0,type:"success",variant:"tonal",border:"start",elevation:"2",closable:"","close-label":e.$t("close"),text:e.alert_text,class:"mb-8"},null,8,["close-label","text"])):f("",!0),i(B,{"fast-fail":"",onSubmit:t[3]||(t[3]=N(()=>{},["prevent"])),ref:"form"},{default:o(()=>[i(b,{modelValue:e.evaluation.title,"onUpdate:modelValue":t[0]||(t[0]=s=>e.evaluation.title=s),label:e.$t("evaluation_title"),rules:e.NameRules},null,8,["modelValue","label","rules"]),i(Q,{label:e.$t("side_profile_title"),modelValue:e.evaluation.side_profile_id,"onUpdate:modelValue":t[1]||(t[1]=s=>e.evaluation.side_profile_id=s),items:e.sideProfile},null,8,["label","modelValue","items"]),i(H,{modelValue:e.evaluation.six_month,"onUpdate:modelValue":t[2]||(t[2]=s=>e.evaluation.six_month=s),label:e.$t("evaluation_exception")},null,8,["modelValue","label"]),i(k,{fluid:""},{default:o(()=>[i(E,null,{default:o(()=>[(a(!0),d(h,null,V(e.headers,s=>(a(),u(I,{key:s.id},{default:o(()=>[e.headerAndQuestions?(a(),u(m,{key:0,header:s,questionsAndHeader:e.headerAndQuestions[s.id],onQuestionInputs:n.addQuestion},null,8,["header","questionsAndHeader","onQuestionInputs"])):f("",!0)]),_:2},1024))),128))]),_:1})]),_:1}),i(v,{type:"submit",onClick:n.submit,block:"",class:"mt-2"},{default:o(()=>[A(q(e.$t("submit")),1)]),_:1},8,["onClick"])]),_:1},512)]),_:1})}const J=c(T,[["render",j]]);export{J as default};
